---
title: "なぜ今、モジュラーモノリスという意思決定をしたのか ― 新しいContextとドメイン設計を起点にしたアーキテクチャ転換 ―"
emoji: "🏗️"
type: "tech"
topics:
  - "architecture"
  - "ddd"
  - "go"
  - "monolith"
published: false
publication_name: "pivotmedia"
---

## はじめに

この記事は、特定の技術やフレームワークの解説を目的としたものではありません。また、ある設計が常に正しいと主張するものでもありません。PIVOTで新機能（コメント機能）を開発するにあたり、なぜこのタイミングで「モジュラーモノリス」というアーキテクチャ判断をしたのか、その背景にあった問題意識と意思決定の流れを記録として残すことを目的としています。

---

## 1. Go移行によって「次に進める状態」にはなっていた

PIVOTのバックエンドは、段階的にPHPからGoへ移行してきました。この移行でまず重視していたのは、設計を美しくすることではなく、運用可能で、これ以上負債が増えない状態を作ることでした。Statelessでコンテナ化できるコードにすること、VM上のState前提で動く実装をなくすこと、運用・保守を前提とした最低限の健全化を行うことは、スタートアップにおいて避けて通れない重要なフェーズだったと思います。

一方で、Goに移行したからといって、すべてが解決したわけではありませんでした。古い実装をそのままGoに持ってきた部分も多く、触りづらさや見通しの悪さは少なからず残っていました。「次にどこを直すべきか」という課題感はありましたが、この段階ではまだ、抜本的な設計変更に踏み切る必然性は強くありませんでした。

---

## 2. 課題の「重要度」が変わっていった

実装が手続き的になっていること、ドメインがコード上で十分に表現されていないこと、変更の影響範囲が読みづらいことは、以前から認識していた課題でした。ただし当時は、「いつか向き合うべき課題」の一つという位置づけに留まっていました。

技術アドバイザーとして入っていただいている川島さんとの継続的な議論の中で、この課題に対する認識が徐々に変わっていきました。本質的複雑さと偶有的複雑さの整理、ニューレガシーアンチパターンという言語化、画面駆動・テーブル駆動設計への自覚などを通じて、問題の所在がより明確になっていきました。

特に印象的だったのは、AI時代において人間が担うべき仕事は、依存の中心となるドメインを定義することだけである、という考え方です。実装や配線、定型的な処理は今後AIがいくらでも支援できる一方で、どこに境界を引き、どんな言語で世界を切り取るかという判断は人間にしかできません。この認識を持ったことで、ドメイン設計は「後で改善すればよいもの」ではなく、今後の開発効率や変更耐性を左右する中核的な課題として捉えるようになりました。

---

## 3. 新しいContextの機能開発という転機

そのタイミングで始まったのが、コメント機能の開発でした。既存のシステムは、映像Viewerを中心としたコンテンツ配信が前提で、ユーザーは「見る側」として完結しており、インタラクションはほとんど想定されていませんでした。一方、コメント機能はユーザー参加型であり、既存機能とは明らかに異なる関心やルールを持つ世界です。

この機能を既存の構造にそのまま載せると歪みが生じることは明らかでしたが、同時にこれは好機でもありました。新しいContextであるため既存コードを大きく壊さずに始められること、境界を自然に定義できること、今後の指針となるロールモデルを作れることが揃っていました。ここで初めて、ドメイン設計に本気で取り組む条件が揃ったと判断しました。

---

## 4. マイクロサービスではなく「モジュラーモノリス」を選んだ

この段階でマイクロサービス化を検討しなかったわけではありませんが、チームと組織の現実を考えると最適解ではありませんでした。バックエンドの正社員エンジニアは実質一人であり、実行環境を分割するほどの複雑性や人員規模でもなかったためです。逆コンウェイの法則を考えると、組織が分かれていないのに実装だけを分けるのは不自然であり、不用意な分割はコストと複雑さを増やすだけだと判断しました。

そこで選んだのが、境界（Bounded Context）は明確に分けるが、実行・デプロイ単位は分けない、というモジュラーモノリスのアプローチです。今のフェーズにおける現実解として、これが最もバランスの取れた判断だと考えています。

---

## 5. 「ドメインを定義する」という意思決定

今回意識したのは、Contextごとに意味を明確に切り分けることです。同じオブジェクトであってもContextが違えば関心のある情報や振る舞いは異なり、それらを無理に共通化するとモデルは肥大化していきます。そのため、Contextごとにドメイン言語を持ち、その世界でのみ通じる言葉を許容し、境界を越えた意味の混線を防ぐことを重視しました。

コメント機能は、その最初のロールモデルとして位置づけています。今後の新機能は、この方針で作っていくという合意をチームで持っています。

---

## 6. 機能開発を遅らせてでも、今やる価値があった

結果として、機能開発に入る前に約2週間、アーキテクチャと構造の整理に時間を使いました。短期的には機能開発が若干後ろ倒しになりますが、PMやチームと合意した上で、全体としてはスピードは落ちないという判断をしました。

実際には、開発者体験が明らかに改善し、ドメインロジックが安定し、複雑な仕様調整を最後までやり切れたという結果につながりました。

---

## おわりに

スタートアップでは「クイック＆ダーティー」が語られがちですが、AI時代においては、クリーンに定義されたドメインこそが結果的にスピードを生むという逆転現象が起きているように感じています。今回の判断は技術選定の話というよりも、優先順位と意思決定の話でした。

課題は前からありましたが、重要度の認識が変わり、新しいContextという条件が揃ったため「今」やりました。書き換えても違和感が残っている方がいれば、次に向き合うべきは設計かもしれません。